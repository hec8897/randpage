String.prototype.replaceAll = function (org, dest) {
    return this.split(org).join(dest)
};
var QArendingFn = {
    DataRender: function () {
        xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                returnJson = JSON.parse(this.responseText)
            }
        };
        xhttp.open('POST', 'data/data.json', true);
        xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        xhttp.send("data=0")
    }(),
    resultArray: [],
    QaNAnRender: function QaNAnRender(no, mode) {
        if (mode == "reset") {
            this.resultPoint = 0
        }
        var qaRender = document.getElementById('qa_render');
        var AnResult = [];
        if (no == returnJson.length) {
            this.resultRender()
        } else {
            for (var i = 0; i < returnJson[no].answer.length; i++) {
                AnResult.push("<button onclick='QArendingFn.QaNAnRender(" + (no + 1) + ")|QArendingFn.resultArrayPush(" + no + "|" + i + ")|QArendingFn.pointResult(" + no + "|" + returnJson[no].answer[i].point + ")'>" + returnJson[no].answer[i].qa + "</button>")
            }
            var resultArrayHtml = AnResult.toString();
            var replaceAll1 = resultArrayHtml.replaceAll(',', '');
            var replaceAll2 = replaceAll1.replaceAll('|', ',');
            qaRender.innerHTML = "  <span class=\"st_cat step_" + (no + 1) + "\"></span>\n                <h3>" + returnJson[no].question + "</h3>\n                <div>\n                " + replaceAll2 + "\n                </div>"
        }
    },
    resultArrayPush: function resultArrayPush(no, i) {
        this.resultArray.push("" + returnJson[no].answer[i].qa)
    },
    resultPoint: 0,
    pointResult: function pointResult(no, point) {
        this.resultPoint += point
    },
    resultRender: function resultRender() {
        var qaRender = document.getElementById('qa_render');
        if (this.resultPoint >= 20) {
            qaRender.innerHTML = "<h3 class='result_tit result_good'>\uC7AC\uBB34 \uC0C1\uD0DC \uC88B\uC74C</h3>\n                                    <img src='images/result_good.png' alt=\"\uACB0\uACFC \uC544\uC774\uCF58 \uC88B\uC74C\">\n                                    <p>\uB2F9\uC2E0\uC758 \uC7AC\uBB34\uC0C1\uD0DC\uB294 \uC88B\uC740 \uD3B8\uC785\uB2C8\uB2E4.</p>\n                                    <p> \uC790\uC2E0\uC758 \uC7AC\uBB34\uC0C1\uD669\uC744 \uC62C\uBC14\uB974\uAC8C \uD30C\uC545\uD558\uACE0 \uC788\uACE0 \uC7AC\uD14C\uD06C\uC5D0 \uAD00\uC2EC\uC774 \uB9CE\uC544 \uC57D\uAC04\uC758 \uC804\uBB38\uAC00 \uB3C4\uC6C0\uC744 \uB354\uD558\uBA74 \uB3C8\uC744 \uB354\uC6B1 \uD6A8\uACFC\uC801\uC73C\uB85C \uBAA8\uC744 \uC218 \uC788\uC2B5\uB2C8\uB2E4. \uBB34\uB8CC\uC7AC\uBB34 \uC0C1\uB2F4\uC11C\uBE44\uC2A4\uB97C \uD1B5\uD574 \uC218\uC775\uB960 \uC88B\uC740 \uC7AC\uD14C\uD06C \uBC29\uBC95\uC744 \uCD94\uCC9C\uBC1B\uC544 \uBCF4\uC138\uC694.</p>\n                                    <div class='return_btn return_top' onclick='QArendingFn.QaNAnRender(0,\"reset\")'>\uD14C\uC2A4\uD2B8 \uB2E4\uC2DC\uD558\uAE30</div> <div class='return_btn' onclick='gotoInsert()'>\uC0C1\uB2F4 \uC2E0\uCCAD\uD558\uAE30</div>"
        } else if (this.resultPoint >= 14) {
            qaRender.innerHTML = "<h3 class='result_tit result_normal'>\uC7AC\uBB34 \uC0C1\uD0DC \uBCF4\uD1B5</h3>\n                                    <img src='images/result_normal.png' alt=\"\uACB0\uACFC \uC544\uC774\uCF58 \uBCF4\uD1B5\">\n                                    <p>\uB2F9\uC2E0\uC758 \uC7AC\uBB34\uC0C1\uD0DC\uB294 \uBCF4\uD1B5\uC785\uB2C8\uB2E4.</p>\n                                    <p> \uBD80\uC871\uD55C \uBD84\uC57C\uC758 \uAE08\uC735\uC9C0\uC2DD\uC744 \uB298\uB9AC\uACE0, \uB2E8\uACC4\uBCC4 \uC7AC\uBB34\uBAA9\uD45C \uC218\uB9BD\uC744 \uD1B5\uD574 \uB4E0\uB4E0\uD55C \uB178\uD6C4\uB97C \uB9DE\uC774\uD558\uAE30 \uC704\uD55C \uB178\uB825\uC774 \uD544\uC694\uD569\uB2C8\uB2E4. \uBB34\uB8CC\uC7AC\uBB34 \uC0C1\uB2F4\uC11C\uBE44\uC2A4\uB97C \uD1B5\uD574 \uB4E0\uB4E0\uD55C \uC7AC\uBB34\uC124\uACC4\uB97C \uC2DC\uC791\uD574\uBCF4\uC138\uC694.</p>\n                                    <div class='return_btn return_top' onclick='QArendingFn.QaNAnRender(0,\"reset\")'>\uD14C\uC2A4\uD2B8 \uB2E4\uC2DC\uD558\uAE30</div><div class='return_btn' onclick='gotoInsert()'>\uC0C1\uB2F4 \uC2E0\uCCAD\uD558\uAE30</div>"
        } else {
            qaRender.innerHTML = "<h3 class='result_tit result_bad'>\uC7AC\uBB34 \uC0C1\uD0DC \uB098\uC068</h3>\n                                    <img src='images/result_bad.png' alt=\"\uACB0\uACFC \uC544\uC774\uCF58 \uB098\uC068\">\n                                    <p>\uB2F9\uC2E0\uC758 \uC7AC\uBB34\uC0C1\uD0DC\uB294 \uB098\uC068\uC785\uB2C8\uB2E4.</p>\n                                    <p> \uC62C\uBC14\uB978 \uC18C\uBE44, \uC800\uCD95, \uBD80\uCC44\uAD00\uB9AC\uB294 \uBB3C\uB860 \uB4E0\uB4E0\uD55C \uC7AC\uBB34\uBAA9\uD45C \uC124\uC815\uC774 \uC2DC\uAE09\uD569\uB2C8\uB2E4. \uC7AC\uBB34\uC804\uBB38\uAC00\uB97C \uD1B5\uD574 \uBAA9\uD45C \uC5C6\uB294 \uC7AC\uD14C\uD06C \uD22C\uC790\uBCF4\uB2E4\uB294 \uAC74\uAC15\uD55C \uB3C8\uAD00\uB9AC \uC2B5\uAD00\uC744 \uAE38\uB7EC\uBCF4\uC138\uC694. </p>\n                                    <div class='return_btn return_top' onclick='QArendingFn.QaNAnRender(0,\"reset\")'>\uD14C\uC2A4\uD2B8 \uB2E4\uC2DC\uD558\uAE30</div><div class='return_btn' onclick='gotoInsert()'>\uC0C1\uB2F4 \uC2E0\uCCAD\uD558\uAE30</div>"
        }
    }
};

function gotoInsert() {
    var FormTag = $('#form').offset();
    $('html,body').animate({
        scrollTop: FormTag.top
    }, 1000)
}
var dataInserter = {
    params: '',
    getQueryString: function () {
        params = {};
        window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (str, key, value) {
            params[key] = value
        });
        return params
    }(),
    InsertdataArray: [],
    dataInsert: function dataInsert() {
        var reqName = document.getElementById('reqname').value;
        var reqBirth = document.getElementById('reqbirth').value;
        var reqPhone = document.getElementById('reqphone').value;
        var reqArea = document.getElementById('reqarea').value;
        var reqMemo = document.getElementById('reqmemo').value;
        var reqCheckM = document.getElementById('radio_1').checked;
        var reqCheckW = document.getElementById('radio_2').checked;
        var reqChecked = document.getElementById('checkbox_1').checked;
        var reqSexflag;
        if (reqCheckM == true) {
            reqSexflag = '남성'
        } else if (reqCheckW == true) {
            reqSexflag = '여성'
        }
        if (reqName == "") {
            alert('성함을 입력해주세요')
        } else if (reqBirth == "") {
            alert('생년월일을 입력해주세요')
        } else if (reqCheckM == false && reqCheckW == false) {
            alert('성별을 선택해주세요')
        } else if (reqPhone == "") {
            alert('연락처를 입력해주세요')
        } else if (reqArea == "") {
            alert('지역을 선택해주세요')
        } else if (reqMemo == "") {
            alert('상담 분야를 선택하세요')
        } else if (reqChecked == false) {
            alert('개인정보수집 및 이용에 동의 해주세요')
        } else {
            var insert = confirm('입력하신 정보로 상담신청 하시겠습니까?');
            if (insert == true) {
                data = [{
                    TestAnsewer: QArendingFn.resultArray
                }, {
                    reqName: reqName,
                    reqBirth: reqBirth,
                    reqPhone: reqPhone,
                    reqArea: reqArea,
                    reqMemo: reqMemo,
                    reqSexflag: reqSexflag,
                    adget:params.id,
                    Idkey:params.idkey
                }];
                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function () {
                    if (this.readyState == 4 && this.status == 200) {
                        var returnInsert = JSON.parse(this.responseText);
                        if (returnInsert.phpresult == 'ok') {
                            alert('상담신청이 완료되었습니다:)')
                        } else {
                            alert('상담신청 실패 관리자에게 문의해주세요')
                        }
                    }
                };
                xhttp.open('POST', 'php/insert.php', true);
                xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                xhttp.send("data=" + JSON.stringify(data))
            }
        }
    }
};